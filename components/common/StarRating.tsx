interface StarRatingProps {
  rating: number; // 0 ~ 5
  size?: number; // 기본 24px
  className?: string;
}

// 꽉 찬 별
const FilledStar = ({ size }: { size: number }) => (
  <svg
    width={size}
    height={size}
    viewBox="0 0 42 42"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M19.004 6.1467C19.634 4.2126 22.3703 4.2126 22.9982 6.1467L25.2452 13.0599C25.3825 13.4809 25.6494 13.8478 26.0077 14.108C26.366 14.3683 26.7974 14.5086 27.2402 14.5089H34.5104C36.5453 14.5089 37.3895 17.1129 35.7452 18.3099L29.8652 22.5813C29.5062 22.8418 29.2388 23.2092 29.1015 23.631C28.9642 24.0528 28.964 24.5072 29.1008 24.9291L31.3478 31.8423C31.9778 33.7764 29.7623 35.3871 28.1138 34.1901L22.2338 29.9187C21.8751 29.6583 21.4433 29.5181 21.0001 29.5181C20.5568 29.5181 20.125 29.6583 19.7663 29.9187L13.8863 34.1901C12.2399 35.3871 10.0265 33.7764 10.6544 31.8423L12.9014 24.9291C13.0383 24.5072 13.038 24.0528 12.9007 23.631C12.7634 23.2092 12.4961 22.8418 12.137 22.5813L6.25912 18.312C4.61482 17.115 5.46112 14.511 7.49392 14.511H14.762C15.2052 14.5111 15.6371 14.371 15.9958 14.1107C16.3545 13.8505 16.6217 13.4834 16.7591 13.062L19.0061 6.1488L19.004 6.1467Z"
      fill="#FBA613"
    />
  </svg>
);

// 빈 별
const EmptyStar = ({ size }: { size: number }) => (
  <svg
    width={size}
    height={size}
    viewBox="0 0 42 42"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M19.004 6.1467C19.634 4.2126 22.3703 4.2126 22.9982 6.1467L25.2452 13.0599C25.3825 13.4809 25.6494 13.8478 26.0077 14.108C26.366 14.3683 26.7974 14.5086 27.2402 14.5089H34.5104C36.5453 14.5089 37.3895 17.1129 35.7452 18.3099L29.8652 22.5813C29.5062 22.8418 29.2388 23.2092 29.1015 23.631C28.9642 24.0528 28.964 24.5072 29.1008 24.9291L31.3478 31.8423C31.9778 33.7764 29.7623 35.3871 28.1138 34.1901L22.2338 29.9187C21.8751 29.6583 21.4433 29.5181 21.0001 29.5181C20.5568 29.5181 20.125 29.6583 19.7663 29.9187L13.8863 34.1901C12.2399 35.3871 10.0265 33.7764 10.6544 31.8423L12.9014 24.9291C13.0383 24.5072 13.038 24.0528 12.9007 23.631C12.7634 23.2092 12.4961 22.8418 12.137 22.5813L6.25912 18.312C4.61482 17.115 5.46112 14.511 7.49392 14.511H14.762C15.2052 14.5111 15.6371 14.371 15.9958 14.1107C16.3545 13.8505 16.6217 13.4834 16.7591 13.062L19.0061 6.1488L19.004 6.1467Z"
      fill="#E0E0E0"
    />
  </svg>
);

// 반 별
const HalfStar = ({ size }: { size: number }) => (
  <svg
    width={size}
    height={size}
    viewBox="0 0 42 42"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M19.004 6.1467C19.634 4.2126 22.3703 4.2126 22.9982 6.1467L25.2452 13.0599C25.3825 13.4809 25.6494 13.8478 26.0077 14.108C26.366 14.3683 26.7974 14.5086 27.2402 14.5089H34.5104C36.5453 14.5089 37.3895 17.1129 35.7452 18.3099L29.8652 22.5813C29.5062 22.8418 29.2388 23.2092 29.1015 23.631C28.9642 24.0528 28.964 24.5072 29.1008 24.9291L31.3478 31.8423C31.9778 33.7764 29.7623 35.3871 28.1138 34.1901L22.2338 29.9187C21.8751 29.6583 21.4433 29.5181 21.0001 29.5181C20.5568 29.5181 20.125 29.6583 19.7663 29.9187L13.8863 34.1901C12.2399 35.3871 10.0265 33.7764 10.6544 31.8423L12.9014 24.9291C13.0383 24.5072 13.038 24.0528 12.9007 23.631C12.7634 23.2092 12.4961 22.8418 12.137 22.5813L6.25912 18.312C4.61482 17.115 5.46112 14.511 7.49392 14.511H14.762C15.2052 14.5111 15.6371 14.371 15.9958 14.1107C16.3545 13.8505 16.6217 13.4834 16.7591 13.062L19.0061 6.1488L19.004 6.1467Z"
      fill="#E0E0E0"
    />
    <mask
      id="halfStarMask"
      style={{ maskType: "luminance" }}
      maskUnits="userSpaceOnUse"
      x="0"
      y="0"
      width="21"
      height="42"
    >
      <path d="M21 0H0V42H21V0Z" fill="white" />
    </mask>
    <g mask="url(#halfStarMask)">
      <path
        d="M19.004 6.1467C19.634 4.2126 22.3703 4.2126 22.9982 6.1467L25.2452 13.0599C25.3825 13.4809 25.6494 13.8478 26.0077 14.108C26.366 14.3683 26.7974 14.5086 27.2402 14.5089H34.5104C36.5453 14.5089 37.3895 17.1129 35.7452 18.3099L29.8652 22.5813C29.5062 22.8418 29.2388 23.2092 29.1015 23.631C28.9642 24.0528 28.964 24.5072 29.1008 24.9291L31.3478 31.8423C31.9778 33.7764 29.7623 35.3871 28.1138 34.1901L22.2338 29.9187C21.8751 29.6583 21.4433 29.5181 21.0001 29.5181C20.5568 29.5181 20.125 29.6583 19.7663 29.9187L13.8863 34.1901C12.2399 35.3871 10.0265 33.7764 10.6544 31.8423L12.9014 24.9291C13.0383 24.5072 13.038 24.0528 12.9007 23.631C12.7634 23.2092 12.4961 22.8418 12.137 22.5813L6.25912 18.312C4.61482 17.115 5.46112 14.511 7.49392 14.511H14.762C15.2052 14.5111 15.6371 14.371 15.9958 14.1107C16.3545 13.8505 16.6217 13.4834 16.7591 13.062L19.0061 6.1488L19.004 6.1467Z"
        fill="#FBA613"
      />
    </g>
  </svg>
);

export default function StarRating({ rating, size = 24, className }: StarRatingProps) {
  const clampedRating = Math.max(0, Math.min(5, rating));

  // 별 개수 계산
  const fullStars = Math.floor(clampedRating);
  const hasHalfStar = clampedRating - fullStars >= 0.5;
  const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);

  return (
    <div className={`flex items-center gap-0.5 ${className ?? ""}`}>
      {/* 꽉 찬 별 */}
      {Array.from({ length: fullStars }, (_, i) => (
        <FilledStar key={`filled-${i}`} size={size} />
      ))}

      {/* 반 별 */}
      {hasHalfStar && <HalfStar size={size} />}

      {/* 빈 별 */}
      {Array.from({ length: emptyStars }, (_, i) => (
        <EmptyStar key={`empty-${i}`} size={size} />
      ))}
    </div>
  );
}
